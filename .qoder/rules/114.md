---
trigger: always_on
---
# 家庭健康管理系统 - 前端开发规范 (Vue3 + Element Plus)

## 技术栈
- **框架**：Vue 3.x (Composition API)
- **UI库**：Element Plus 2.x
- **构建工具**：Vite 4.x
- **路由**：Vue Router 4.x
- **状态管理**：Pinia 2.x
- **HTTP客户端**：Axios
- **工具库**：dayjs（时间处理）、echarts（图表）

## 项目结构
src/
├── api/ # API接口封装
│ ├── auth.js # 认证相关
│ ├── family.js # 家庭管理
│ ├── assessment.js # 体质测评
│ ├── log.js # 健康日志
│ └── recommendation.js # 建议引擎
├── assets/ # 静态资源
├── components/ # 公共组件
│ ├── Layout/ # 布局组件
│ ├── Chart/ # 图表组件
│ └── Common/ # 通用组件
├── views/ # 页面视图
│ ├── Login/
│ ├── Home/
│ ├── Family/
│ ├── Assessment/
│ ├── HealthLog/
│ ├── Recommendation/
│ └── Settings/
├── router/ # 路由配置
├── stores/ # Pinia状态管理
├── utils/ # 工具函数
│ ├── request.js # axios封装
│ ├── auth.js # token处理
│ └── validate.js # 表单验证
├── styles/ # 全局样式
└── App.vue

## 编码规范

### Vue组件规范
- **使用 Composition API**（`<script setup>`）
- **组件命名**：大驼峰（PascalCase），如 `HealthLogCard.vue`
- **Props定义**：使用 TypeScript 或 defineProps + 默认值
- **Emits定义**：显式声明 defineEmits
- **生命周期**：优先使用 Composition API 钩子（onMounted、onUnmounted）

### Element Plus使用规范
- **按需引入**：使用自动导入插件（unplugin-vue-components）
- **主题定制**：在 `styles/element-variables.scss` 中覆盖CSS变量
- **表单验证**：使用 Element Plus 的 rules 机制
- **消息提示**：统一使用 ElMessage、ElNotification
- **确认框**：统一使用 ElMessageBox

### 目录与命名约定
- **页面文件**：index.vue（主页面）+ components/（子组件）
- **API文件**：按模块划分，导出具名函数
- **Store文件**：useXxxStore，如 useUserStore、useFamilyStore
- **工具函数**：小驼峰命名，单一职责

## 核心功能实现要点

### 1. 路由与权限
- **路由守卫**：检查 token，未登录跳转 /login
- **角色权限**：根据 role 显示/隐藏菜单项
- **面包屑**：自动生成，基于路由 meta

### 2. 状态管理（Pinia）
- **useUserStore**：用户信息、token、角色
- **useFamilyStore**：当前家庭、成员列表
- **useAssessmentStore**：体质测评缓存
- **useLogStore**：健康日志临时数据

### 3. API封装
- **统一响应处理**：拦截器处理 code/message/data
- **Token注入**：请求拦截器自动添加 Authorization
- **错误处理**：401跳转登录，其他错误 ElMessage 提示
- **Loading状态**：全局或局部 loading

### 4. 表单处理
- **表单验证**：Element Plus rules，常见规则封装到 utils/validate.js
- **提交防抖**：按钮添加 loading 状态，防止重复提交
- **数据回显**：编辑时自动填充表单

### 5. 图表可视化（ECharts）
- **健康日志趋势**：折线图（7/14/30天）
- **体质雷达图**：9体质得分
- **达标率饼图**：完成情况统计
- **响应式**：监听窗口变化，自动 resize

### 6. 关键页面要求

#### 登录页
- 手机号/密码登录，表单验证
- 记住密码（localStorage）
- 微信登录（可选，显示二维码）

#### 家庭管理
- 创建/加入家庭（邀请码）
- 成员列表（头像、关系、角色）
- 家庭看板（成员健康概览）

#### 体质测评
- 步进式问卷（ElSteps）
- 进度保存（localStorage）
- 结果展示（雷达图 + 文字解读）
- 历史对比（折线图）

#### 健康日志
- Tab切换类型（饮食/睡眠/运动/情绪/体征）
- 日历视图（ElCalendar）+ 打卡标记
- 趋势图表（7/14/30天）
- 快捷录入模板

#### 建议中心
- 分类卡片（饮食/作息/运动/情绪）
- 可解释证据（ElCollapse 展开）
- 反馈按钮（有用/无用）

#### 提醒设置
- 列表展示（ElTable）
- 新增/编辑（ElDialog + 时间选择）
- 开关控制（ElSwitch）

## 样式规范
- **使用 SCSS**：支持变量、嵌套
- **BEM命名**：`.block__element--modifier`
- **响应式**：断点 768px（移动端）、1024px（平板）
- **主题色**：
  - Primary: #409EFF（Element Plus默认）
  - Success: #67C23A
  - Warning: #E6A23C
  - Danger: #F56C6C
- **间距**：4px倍数（8、12、16、20、24）

## 工具函数示例

### 时间格式化
```javascript
import dayjs from 'dayjs'
export const formatDate = (date, format = 'YYYY-MM-DD') => {
  return dayjs(date).format(format)
}
##Token管理
const TOKEN_KEY = 'access_token'
export const getToken = () => localStorage.getItem(TOKEN_KEY)
export const setToken = (token) => localStorage.setItem(TOKEN_KEY, token)
export const removeToken = () => localStorage.removeItem(TOKEN_KEY)
##表单验证规则
export const phoneRule = { pattern: /^1[3-9]\d{9}$/, message: '手机号格式错误', trigger: 'blur' }
export const requiredRule = { required: true, message: '此项为必填', trigger: 'blur' }
##性能优化
路由懒加载：() => import('./views/...')
组件懒加载：大型图表、编辑器使用 defineAsyncComponent
图片懒加载：使用 v-lazy 或 Intersection Observer
虚拟滚动：长列表使用 ElVirtualList
##安全要点
XSS防护：用户输入使用 v-text 或过滤
敏感数据：不在前端存储明文密码、完整身份证
HTTPS：生产环境强制 HTTPS
Token过期：刷新或跳转登录
##开发调试
Mock数据：开发环境使用 vite-plugin-mock
代理配置：vite.config.js 配置 proxy 到后端 8080
环境变量：.env.development / .env.production
##Git提交规范
feat: 新功能
fix: 修复bug
style: 样式调整
refactor: 重构
perf: 性能优化
chore: 构建/配置
##交付要求
响应式适配：支持1920px、1366px、768px
浏览器兼容：Chrome、Edge、Safari最新版
无障碍：合理使用 aria-label
加载状态：所有异步操作显示loading
错误提示：网络错误、业务错误友好提示
##AI助手指令
生成Vue3代码时，请：
使用 <script setup> 语法
使用 Element Plus 组件
添加完整的表单验证
包含 loading 和 error 状态处理
一定要添加注释说明关键逻辑
响应式设计（移动端友好）
提供对应的API调用示例