server:
  port: 8080

spring:
  datasource:
    url: jdbc:mysql://localhost:3306/health_family?useSSL=false&allowPublicKeyRetrieval=true&useUnicode=true&characterEncoding=utf8&serverTimezone=Asia/Shanghai
    username: root
    password: 123456
    driver-class-name: com.mysql.cj.jdbc.Driver

  ai:
    ollama:
      base-url: http://localhost:11434/
      init:
        pull-model-strategy: never
        timeout: 300s # Increase timeout for large models/images
      chat:
        options:
          model: qwen2.5:7b
          temperature: 0.7
          timeout: 120s  # ğŸ”¥ æ–°å¢ï¼šè®¾ç½® 120 ç§’è¶…æ—¶
          num-predict: 512  # ğŸ”¥ æ–°å¢ï¼šé™åˆ¶ç”Ÿæˆé•¿åº¦ï¼ŒåŠ å¿«å“åº”
          top-p: 0.9  # ğŸ”¥ æ–°å¢ï¼šæé«˜è¾“å‡ºè´¨é‡
      embedding:
        model: nomic-embed-text # æ¢å¤ä½¿ç”¨ä¸“ä¸šçš„ embedding æ¨¡å‹
      vision:
        model: qwen2.5vl:3b
        temperature: 0.3
        model-candidates: qwen2.5vl:3b,llava:7b

  rag:
    vector-store-path: ./vector-store.json
    topK: 4
    minScore: 0.4

  jpa:
    hibernate:
      ddl-auto: update  # ä½¿ç”¨updateç¡®ä¿è¡¨ç»“æ„åŒæ­¥
    show-sql: false  # å…³é—­SQLæ—¥å¿—ï¼Œé¿å…å¤§é‡è¾“å‡º
    properties:
      hibernate:
        format_sql: true  # æ ¼å¼åŒ–SQLè¾“å‡º
        dialect: org.hibernate.dialect.MySQL8Dialect  # ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„æ–¹è¨€

  jackson:
    serialization:
      INDENT_OUTPUT: false
      FAIL_ON_EMPTY_BEANS: false  # ğŸ”¥ æ–°å¢ï¼šé¿å…åºåˆ—åŒ–ç©ºå¯¹è±¡æ—¶æŠ¥é”™
    deserialization:
      ADJUST_DATES_TO_CONTEXT_TIME_ZONE: false  # ğŸ”¥ æ–°å¢ï¼šä¿æŒæ—¥æœŸæ—¶åŒºä¸å˜
    date-format: yyyy-MM-dd HH:mm:ss  # ğŸ”¥ æ–°å¢ï¼šè®¾ç½®æ—¥æœŸæ ¼å¼
    time-zone: Asia/Shanghai  # ğŸ”¥ æ–°å¢ï¼šè®¾ç½®æ—¶åŒº
  sql:
    init:
      mode: always
      schema-locations: classpath:database_init.sql

  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 10MB

# æ–‡ä»¶ä¸Šä¼ é…ç½®
file:
  upload-dir: uploads

# æ—¥å¿—é…ç½®
logging:
  level:
    root: INFO
    com.healthfamily: DEBUG  # ğŸ”¥ ä¿®æ”¹ï¼šæ‰€æœ‰ä¸šåŠ¡åŒ…éƒ½å¼€å¯ DEBUG
    com.healthfamily.service.recommendation: DEBUG
    com.healthfamily.service.recommendation.RecommendationAiClient: DEBUG
    com.healthfamily.service.consultation: DEBUG  # ğŸ”¥ æ–°å¢ï¼šå’¨è¯¢æœåŠ¡æ—¥å¿—
    org.springframework.ai: DEBUG  # ğŸ”¥ æ–°å¢ï¼šSpring AI æ¡†æ¶æ—¥å¿—
    org.springframework.web: DEBUG  # ğŸ”¥ æ–°å¢ï¼šWeb è¯·æ±‚æ—¥å¿—
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"  # ğŸ”¥ æ–°å¢ï¼šæ ¼å¼åŒ–æ—¥å¿—è¾“å‡º

# æ¨èç³»ç»Ÿé…ç½®
recommendation:
  maxItems: 6
  ai:
    prompt-version: v1
    per-category-limit: 3
    strict-mode-default: false
    model: qwen2.5:7b
    format: json  # ğŸ”¥ æ–°å¢ï¼šæ¨èç³»ç»Ÿä¸“ç”¨çš„ JSON æ ¼å¼é…ç½®
    timeout: 120s  # ğŸ”¥ æ–°å¢ï¼šæ¨èç³»ç»Ÿçš„è¶…æ—¶é…ç½®
    timeoutMs: 120000 # ğŸ”¥ æ–°å¢ï¼šæ¯«ç§’å•ä½è¶…æ—¶
  lambda:
    penaltyContra: 0.8
    preferMatch: 0.2
    distance: 0.3
    adherence: 0.4

# JWT é…ç½®
jwt:
  secret: dev-secret-32-bytes-minimum-length-please-1234
  issuer: health-family
  accessTokenValidityMinutes: 120


# Actuator é…ç½®
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics  # ğŸ”¥ æ–°å¢ï¼šmetrics ç«¯ç‚¹
  endpoint:
    health:
      show-details: always  # ğŸ”¥ æ–°å¢ï¼šæ˜¾ç¤ºå¥åº·æ£€æŸ¥è¯¦æƒ…
